@model ITAssetKeeper.Models.ViewModels.Device.DeviceDto

@{
    ViewData["Title"] = "機器情報";
}

@* タイトルバー *@
<div class="contents-header-bar mb-4">
    機器情報
</div>

@*  メッセージ表示 *@
@if (TempData["ToastMessage"] != null)
{
    <div id="toast-message"
         data-message="@TempData["ToastMessage"]"
         data-type="success"></div>
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-warning mt-3">
        @TempData["ErrorMessage"]
    </div>
}

@if (TempData["FailureMessage"] != null)
{
    <div class="alert alert-danger mt-3">
        @TempData["FailureMessage"]
    </div>
}

@* キャンセルボタン *@
<div class="details-back-area">
    <a asp-controller="Device" asp-action="Index" class="btn-back">一覧へ戻る</a>
</div>

@* 機器情報表示エリア *@
<div class="form-box">
    <div class="details-grid">

        @* 1行目：2列 *@
        <div class="details-grid grid-2col">
            @* 機器管理ID(ManagementId) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.ManagementId)</label>
                <div>@Model.ManagementId</div>
            </div>

            @* 設置場所(Location) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.Location)</label>
                <div>@Model.Location</div>
            </div>
        </div>

        @* 2行目：2列 *@
        <div class="details-grid grid-2col">
            @* 種別(Category) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.Category)</label>
                <div>@Model.Category</div>
            </div>

            @* 使用者(UserName) *@
            <div class="form-group mb-2">
                <label class="custom-label">@Html.DisplayNameFor(m => m.UserName)</label>
                <div>@Model.UserName</div>
            </div>
        </div>

        @* 3行目：2列 *@
        <div class="details-grid grid-2col">
            @* 用途(Purpose) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.Purpose)</label>
                <div>@Model.Purpose</div>
            </div>

            @* 状態(Status) *@
            <div class="form-group mb-2">
                <label class="custom-label">@Html.DisplayNameFor(m => m.Status)</label>
                <div>@Model.Status</div>
            </div>
        </div>

        @* 4行目：2列 *@
        <div class="details-grid grid-2col">
            @* 型番(ModelNumber) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.ModelNumber)</label>
                <div>@Model.ModelNumber</div>
            </div>

            @* 購入日(PurchaseDate) *@
            <div class="form-group mb-2">
                <label class="custom-label">@Html.DisplayNameFor(m => m.PurchaseDate)</label>
                <div>@Model.PurchaseDateText</div>
            </div>
        </div>

        @* 5行目：2列 *@
        <div class="details-grid grid-2col">
            @* 製造番号(SerialNumber) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.SerialNumber)</label>
                <div>@Model.SerialNumber</div>
            </div>

            @* 登録日(CreatedAt) *@
            <div class="form-group mb-2">
                <label class="custom-label">@Html.DisplayNameFor(m => m.CreatedAt)</label>
                <div>@Model.CreatedAtDateTimeText</div>
            </div>
        </div>

        @* 6行目：2列 *@
        <div class="details-grid grid-2col">
            @* ホスト名(HostName) *@
            <div class="form-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.HostName)</label>
                <div>@Model.HostName</div>
            </div>

            @* 更新日(UpdatedAt) *@
            <div class="form-group mb-2">
                <label class="custom-label">@Html.DisplayNameFor(m => m.UpdatedAt)</label>
                <div>@Model.UpdatedAtDateTimeText</div>
            </div>
        </div>

        @* 7行目：1列 *@
        <div class="details-grid grid-1col">
            @* メモ欄(Memo) *@
            <div class="form-group details-memo-group">
                <label class="custom-label">@Html.DisplayNameFor(m => m.Memo)</label>
                <div class="memo-box">@Model.Memo</div>
            </div>
        </div>

        @* 編集 / 削除ボタン *@
        <div class="details-footer">

            @* 編集ボタン *@
            @* ロール判定で編集や削除を制限 *@
            @if (User.IsInRole("Admin") || User.IsInRole("Editor"))
            {
                <a asp-action="Edit" asp-route-id="@Model.Id" class="btn-edit">編集</a>
            }

            @* 削除ボタン *@
            @if (User.IsInRole("Admin"))
            {
                @* 削除ボタン：モーダル起動 *@
                <button type="button"
                        class="btn-delete"
                        id="btnOpenDeleteModal"
                        data-device-id="@Model.Id"
                        data-device-mgmtid="@Model.ManagementId"
                        data-device-category="@Model.Category"
                        data-device-status="@Model.Status"
                        data-device-user="@Model.UserName">
                    削除
                </button>
            }
        </div>
    </div>
</div>


@* モーダル：削除確認用 *@
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            @* モーダルヘッダー *@
            <div class="modal-header">
                <h5 class="modal-title d-flex align-items-center gap-2">
                    <img src="~/img/warning.png" alt="warning" class="modal-icon" />
                    削除確認
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            @* モーダルbody *@
            <div class="modal-body">
                <p>対象の機器情報を削除します。よろしいですか？</p>
                <div class="row mb-2">
                    <div class="col-3 fw-bold">@Html.DisplayNameFor(m => m.ManagementId)</div>
                    <div class="col-9" id="delMgmtId"></div>
                </div>

                <div class="row mb-2">
                    <div class="col-3 fw-bold">@Html.DisplayNameFor(m => m.Category)</div>
                    <div class="col-9" id="delCategory"></div>
                </div>

                <div class="row mb-2">
                    <div class="col-3 fw-bold">@Html.DisplayNameFor(m => m.Status)</div>
                    <div class="col-9" id="delStatus"></div>
                </div>

                <div class="row mb-2">
                    <div class="col-3 fw-bold">@Html.DisplayNameFor(m => m.UserName)</div>
                    <div class="col-9" id="delUser"></div>
                </div>
            </div>

            @* モーダルフッター *@
            <div class="modal-footer">
                <button type="button" class="modal-close-btn me-auto" data-bs-dismiss="modal">キャンセル</button>
                <button type="button" id="btnDeleteExec" class="modal-negative-btn">削除</button>
            </div>

        </div>
    </div>
</div>

@* 外部JS読み込み *@
@section Scripts {
    <script src="~/js/device-delete.js"></script>
} 

